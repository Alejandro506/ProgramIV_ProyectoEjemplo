@{
    ViewData["Title"] = "Animales por Cliente";
    var clientes = ViewBag.Clientes as List<SelectListItem> ?? new();
    var rows = ViewBag.Rows as List<myFirstProject.Controllers.ReportesController.RowAnimalCliente> ?? new();
    int? idCliente = ViewBag.IdCliente as int?;
}
<h2 class="mb-3">Animales por Cliente</h2>

<form class="row gy-2 gx-2 align-items-end mb-3" method="get">
  <div class="col-md-4">
    <label class="form-label">Cliente</label>
    <select name="idCliente" class="form-select" asp-items="clientes">
      <option value="">— Selecciona —</option>
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-primary"><i class="fa fa-search me-1"></i>Buscar</button>
  </div>
</form>

@if (!rows.Any())
{
  <div class="alert alert-info">Selecciona un cliente para ver sus animales.</div>
}
else
{
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead>
        <tr>
          <th>#</th>
          <th>Animal</th>
          <th>Total Citas</th>
          <th>Última cita</th>
        </tr>
      </thead>
      <tbody>
      @foreach (var r in rows)
      {
        <tr>
          <td>@r.IdAnimal</td>
          <td>@r.Animal</td>
          <td>@r.TotalCitas</td>
          <td>@(r.UltimaCita?.ToString("dd/MM/yyyy HH:mm") ?? "Nunca")</td>
        </tr>
      }
      </tbody>
    </table>
  </div>
}
